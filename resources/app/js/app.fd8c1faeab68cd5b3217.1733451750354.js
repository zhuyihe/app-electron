(function(t){function e(e){for(var i,o,a=e[0],l=e[1],c=e[2],d=0,u=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&u.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);p&&p(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var l=n[a];0!==r[l]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},s=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="app://./";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var p=l;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0a95":function(t,e,n){},"34bb":function(t,e){t.exports=require("electron")},"44ec":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"printPdf"},[e("el-button",{attrs:{size:"small"},on:{click:t.back}},[t._v("返回")])],1)},r=[],s={created(){this.init()},methods:{init(){let t=this.$electronStore.get("pdf");console.log(t,"ccc")},back(){this.$router.push("/")}}},o=s,a=n("0b56"),l=Object(a["a"])(o,i,r,!1,null,null,null);e["default"]=l.exports},"56d7":function(t,e,n){"use strict";n.r(e);var i=n("8642"),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},s=[],o={name:"App",components:{},data(){return{}},mounted(){},methods:{}},a=o,l=(n("5dea"),n("0b56")),c=Object(l["a"])(a,r,s,!1,null,null,null),p=c.exports,d=n("1ceb");const u=n("8945").default,h=n("e904").default,f=n("44ec").default;i["default"].use(d["a"]);const m=[{path:"/",name:"checkStatus",component:u},{path:"/printEmr",name:"printEmr",component:h},{path:"/printPdf",name:"printPdf",component:f}],g=new d["a"]({mode:"hash",routes:m}),v=d["a"].prototype.push;d["a"].prototype.push=function(t){return v.call(this,t).catch(t=>t)};var b=g,y=n("63b8"),w=n.n(y);n("1c2f");i["default"].use(w.a);var _=n("34bb");const k={printHtml:{async get(t,e){await _["ipcRenderer"][t]("printHtml",(t,n)=>(console.log(n,"arg"),e(t,n)))},remove(){_["ipcRenderer"].removeAllListeners("printHtml")}},printPdf:{async get(t,e){await _["ipcRenderer"][t]("printPdf",(t,n)=>(console.log(n,"arg"),e(t,n)))},remove(){_["ipcRenderer"].removeAllListeners("printPdf")}},update:{async get(t,e){await _["ipcRenderer"][t]("update",(t,n)=>e(t,n))},remove(){_["ipcRenderer"].removeAllListeners("update")}},checkForUpdate:{async get(t,e){await _["ipcRenderer"][t]("checkForUpdate",(t,n)=>e(t,n))},remove(){_["ipcRenderer"].removeAllListeners("checkForUpdate")}}};var C=k;const P=n("9b0f");var S={install(t){t.prototype.$electronStore=P.getGlobal("$electronStore"),t.prototype.$webContents=P.getGlobal("webContents"),t.prototype.$windows=P.getGlobal("$windows"),t.prototype.$isDevMode=P.getGlobal("$isDevMode"),t.prototype.$ipcRenderers=C,t.prototype.$windowService=P.getGlobal("$windowService")}};n("e222");i["default"].config.productionTip=!1,i["default"].use(S),new i["default"]({router:b,render:t=>t(p)}).$mount("#app")},"5dea":function(t,e,n){"use strict";n("0a95")},"67e8":function(t,e,n){"use strict";n("a7a3")},"6e26":function(t,e,n){},8945:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isUpdatte||t.isPartUpdatte,expression:"isUpdatte || isPartUpdatte"}],staticClass:"connectToweb",attrs:{"element-loading-text":t.loadingText,"element-loading-spinner":"el-icon-loading"}},[t._v(" 当前版本："+t._s(t.version)+" "),e("div",{staticClass:"tip"},[e("div",[t._v(t._s(t.printerStutas.msg))]),e("div",[t.printerStutas.type?e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-chenggong"}})]):e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-shibai"}})])])]),e("el-dialog",{attrs:{title:"更新提示",visible:t.dialogVisible,width:"500px","show-close":!1,"close-on-click-modal":!1,"custom-class":"updateDialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.isUpdatte?t._e():e("div",[e("span",{staticClass:"spanicon",staticStyle:{"font-weight":"bold"}},[e("i",{staticClass:"el-icon-warning warning"}),t._v("检测到新版本，是否更新？")]),e("el-scrollbar",{staticStyle:{height:"100%"}},[t.releaseNotes.length?e("div",{staticClass:"releaseNotes"},t._l(t.releaseNotes,(function(n,i){return e("div",{key:i,staticClass:"releaseNotesItem"},[n?e("span",[t._v(t._s(i+1)+"、"+t._s(n))]):t._e()])})),0):t._e()])],1),t.isUpdatte?t._e():e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("稍后")]),e("el-button",{attrs:{type:"primary"},on:{click:t.confirmUpdate}},[t._v("确 定")])],1)]),e("el-dialog",{attrs:{title:"更新提示",visible:t.dartdialogVisible,width:"500px","show-close":!1,"close-on-click-modal":!1,"custom-class":"updateDialog"},on:{"update:visible":function(e){t.dartdialogVisible=e}}},[t.isPartUpdatte?t._e():e("div",[e("span",{staticClass:"spanicon",staticStyle:{"font-weight":"bold"}},[e("i",{staticClass:"el-icon-warning warning"}),t._v("检测到新版本，是否更新？")]),e("el-scrollbar",{staticStyle:{height:"100%"}},[t.releaseNotes.length?e("div",{staticClass:"releaseNotes"},t._l(t.releaseNotes,(function(n,i){return e("div",{key:i,staticClass:"releaseNotesItem"},[n?e("span",[t._v(t._s(i+1)+"、"+t._s(n))]):t._e()])})),0):t._e()])],1),t.isPartUpdatte?t._e():e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dartdialogVisible=!1}}},[t._v("稍后")]),e("el-button",{attrs:{type:"primary"},on:{click:t.confirmpartUpdate}},[t._v("确 定")])],1)])],1)},r=[],s=n("34bb");const o=n("9b0f");var a={name:"connectToweb",data(){return{ioStatus:{msg:"请与客户端链接",type:"disconnect"},printerStutas:{msg:"打印功能准备就绪",type:!0},printList:[],isUpdatte:!1,loadingText:"加载中...",percent:0,dialogVisible:!1,colors:[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#6f7ad3",percentage:60},{color:"#1989fa",percentage:80},{color:"#5cb87a",percentage:100}],releaseNotes:[],dartdialogVisible:!1,isPartUpdatte:!1,version:""}},computed:{customStatus(){return console.log(this.percent),100==this.percent?"success":"exception"}},created(){this.init()},mounted(){this.version=o.app.getVersion(),console.log(o.app.getVersion(),s["ipcRenderer"],"aaa")},methods:{async init(){this.linstenerDartUpdate()},linstenerDartUpdate(){console.log(s["ipcRenderer"].on," ipcRenderer.on"),s["ipcRenderer"].on("UpdatePartMsg",(t,e)=>{console.log(e,"arg");let{flag:n,releaseNotes:i,updateVersion:r}=e;n&&(console.log(n,i,r),this.dartdialogVisible=!0,this.releaseNotes=i.split("\r\n"))})},checkDartUpdate(){let{flag:t,releaseNotes:e,updateVersion:n}=s["ipcRenderer"].sendSync("exist_update");console.log({flag:t,releaseNotes:e,updateVersion:n},"checkDartUpdate"),t&&(this.dartdialogVisible=!0,this.releaseNotes=e.split("\r\n"))},confirmpartUpdate(){this.isPartUpdatte=!0,this.dartdialogVisible=!1,this.loadingText="正在安装更新，请稍等...",s["ipcRenderer"].send("Sure")},update(){s["ipcRenderer"].send("check-update")},confirmUpdate(){this.isUpdatte=!0,this.dialogVisible=!1,s["ipcRenderer"].send("confirm-downloadUpdate")},linstenerUpdate(){let t=this;s["ipcRenderer"].on("UpdateMsg",(e,n)=>{console.log(n,"arg");let i=0;switch(n.state){case 1:t.releaseNotes=n.msg?n.msg.split("\r\n"):[],t.dialogVisible=!0,t.$windows.show();break;case 3:i=Math.floor(n.msg.percent),t.loadingText=`拼命下载中${i}%,请勿退出！`;break;case 4:t.progressStaus="success",t.loadingText="下载完成,开始安装...",s["ipcRenderer"].send("confirm-update");break}})},linstenerPrinter(){this.getPrintListHandle()},getPrintListHandle(){const t=this.$electronStore.get("printerList");this.printList=t.filter(t=>0===t.status),console.log(this.printList,"this.printList"),this.printList.length<=0?this.printerStutas={msg:"打印服务异常,请尝试重启电脑",type:!1}:(this.printerStutas={msg:"打印功能准备就绪",type:!0},this.$electronStore.set("printList",this.printList))},async togoPrint(){this.$ipcRenderers.printHtml.get("on",(t,e)=>{e&&this.checkStatus()}),this.$ipcRenderers.printPdf.get("on",(t,e)=>{console.log(e,"qqq"),e&&this.checkStatus(e)})},checkStatus(t){this.printerStutas.type&&(this.$windows.show(),console.log(this.$windows,t," this.$window"),t?this.$router.push("printPdf"):this.$router.push("printEmr"))}}},l=a,c=(n("c451"),n("0b56")),p=Object(c["a"])(l,i,r,!1,null,null,null);e["default"]=p.exports},"9e66":function(t,e,n){"use strict";n("beab")},a32b:function(t,e){t.exports=require("path")},a7a3:function(t,e,n){},beab:function(t,e,n){},c451:function(t,e,n){"use strict";n("6e26")},e222:function(t,e){!function(t){var e,n,i,r,s,o='<svg><symbol id="icon-chenggong" viewBox="0 0 1024 1024"><path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#52C41A" ></path><path d="M178.614857 557.860571a42.496 42.496 0 0 1 60.123429-60.050285l85.942857 87.625143a42.496 42.496 0 0 1-60.050286 60.123428L178.614857 557.860571z m561.005714-250.148571a42.496 42.496 0 1 1 65.097143 54.637714L394.459429 725.577143a42.496 42.496 0 0 1-65.097143-54.637714l410.112-363.373715z" fill="#FFFFFF" ></path></symbol><symbol id="icon-shibai" viewBox="0 0 1024 1024"><path d="M512.8 512m-423 0a423 423 0 1 0 846 0 423 423 0 1 0-846 0Z" fill="#FF7575" ></path><path d="M481.3 590.7c5.3 15.8 15.8 26.2 31.5 26.2 15.8 0 26.2-10.5 31.5-26.2l21-288.7c0-31.5-26.2-52.5-52.5-52.5-31.5 0-52.5 26.2-52.5 57.8l21 283.4z m31.5 78.8c-31.5 0-52.5 21-52.5 52.5s21 52.5 52.5 52.5 52.5-21 52.5-52.5-21-52.5-52.5-52.5z m0 0" fill="#FFFFFF" ></path></symbol></svg>',a=(a=document.getElementsByTagName("script"))[a.length-1].getAttribute("data-injectcss"),l=function(t,e){e.parentNode.insertBefore(t,e)};if(a&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}function c(){s||(s=!0,i())}function p(){try{r.documentElement.doScroll("left")}catch(t){return void setTimeout(p,50)}c()}e=function(){var t,e=document.createElement("div");e.innerHTML=o,o=null,(e=e.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",e=e,(t=document.body).firstChild?l(e,t.firstChild):t.appendChild(e))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(e,0):(n=function(){document.removeEventListener("DOMContentLoaded",n,!1),e()},document.addEventListener("DOMContentLoaded",n,!1)):document.attachEvent&&(i=e,r=t.document,s=!1,p(),r.onreadystatechange=function(){"complete"==r.readyState&&(r.onreadystatechange=null,c())})}(window)},e904:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"printEmr"},[e("webview",{ref:"printWebview",attrs:{id:"printWebview",src:t.fullPath,nodeintegration:"",webpreferences:"contextIsolation=no"}}),e("div",{staticClass:"printP"},[e("div",{staticClass:"printCon"},[e("div",{domProps:{innerHTML:t._s(t.html)}})]),e("printerConfig",{ref:"cc",on:{sure:t.printEmr,back:t.back}})],1)],1)},r=[],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"printerConfig"},[e("div",{staticClass:"printSet"},[e("p",[t._v("打印设置")]),e("div",[e("div",{staticClass:"bgColor printNum"},[e("p",[t._v("选择打印机")]),e("div",{staticClass:"con"},[e("el-form",{ref:"printInfo",staticClass:"printInfo",attrs:{model:t.printInfo,rules:t.rules,"label-width":"80px",size:"small","label-position":"left"}},[e("el-form-item",{attrs:{label:"打印机",prop:"machine"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.printInfo.machine,callback:function(e){t.$set(t.printInfo,"machine",e)},expression:"printInfo.machine"}},t._l(t.printerList,(function(n){return e("el-option",{key:n.displayName,attrs:{label:n.displayName,value:n.displayName}},[e("span",{staticStyle:{float:"left"}},[t._v(t._s(n.displayName))]),n.isDefault?e("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v("默认")]):t._e()])})),1)],1),e("el-form-item",{attrs:{label:"打印份数",prop:"num"}},[e("el-input",{attrs:{type:"number",min:"1",placeholder:"请输入份数",clearable:""},model:{value:t.printInfo.num,callback:function(e){t.$set(t.printInfo,"num",e)},expression:"printInfo.num"}})],1)],1)],1)]),e("div",{staticClass:"btnGroup"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$emit("back")}}},[t._v("返回")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.sure}},[t._v("打印")])],1)])])])},o=[],a={data(){return{printCon:{width:"",pagedirection:"",html:"",totalPage:1,selectHtml:"",curtPage:1,curtPageHtml:"",ctPrintDesc:"",ctPrintHtml:"",htmlArr:[]},printInfo:{type:1,machine:"",num:1,autoPage:!1,handlePage:!1,auto:0},printerList:[],totalPage:1,pageRange:"",rules:{machine:[{required:!0,message:"请选择打印机",trigger:"blur"}],num:[{required:!0,message:"请输入打印份数",trigger:"blur"}]}}},mounted(){this.init()},methods:{init(){this.printerList=this.$electronStore.get("printList"),console.log(this.printerList,"this.printerList"),this.printInfo.machine=this.printerList.filter(t=>t.isDefault)[0].displayName},sure(){this.$refs.printInfo.validate(t=>{if(!t)return!1;this.$emit("sure",this.printInfo)})}}},l=a,c=(n("9e66"),n("0b56")),p=Object(c["a"])(l,s,o,!1,null,null,null),d=p.exports;const u=n("a32b");var h={name:"printEmr",data(){return{fullPath:u.join(__dirname.replace(/electron\.asar(\\|\/)renderer/,"app.asar"),"print.html"),html:"",printInfo:{},printerList:[],key:""}},components:{printerConfig:d},mounted(){this.init()},methods:{init(){const t=this.$electronStore.get("emrConfig");this.printerList=this.$electronStore.get("printList"),this.html=t.FileStream;const e=this.$refs.printWebview;e.addEventListener("dom-ready",()=>{}),e.addEventListener("ipc-message",t=>{if("webview-print-do"===t.channel){const t={silent:!0,printBackground:!1,deviceName:"Microsoft Print to PDF"};console.log(t,"printInfo"),e.print(t).then(()=>{console.log("print success")}).catch(t=>{console.log(t)})}else console.log(t.channel)}),this.changeEmrContent()},back(){this.$router.push("/")},checkPrinter(t){const e=this.printerList.find(e=>e.displayName===t);console.log(e,this.printerList,"printer"),e&&0===e.status?this.printRender(t):""===t?this.$message({message:"请先设置其他打印机",type:"error",duration:1e3}):this.$message({message:"当前打印机不可用,请重新设置",type:"error"})},printEmr(t){const{machine:e}=t;console.log(t,"printInfo"),this.printInfo=t,this.checkPrinter(e)},printRender(t){console.log(this.fullPath,"dddd");const e=this.$refs.printWebview;e.send("webview-print-render",{content:this.html,parent:"webview"})},async changeEmrContent(){this.$ipcRenderers.printHtml.get("on",(t,e)=>{if(e){let t=this.$electronStore.get("emrContents");t&&t!==this.html?this.html=t:this.$message.warning("内容未改变")}})}},destroyed(){this.$ipcRenderers.printHtml.remove()}},f=h,m=(n("67e8"),Object(c["a"])(f,i,r,!1,null,"a9acf7fc",null));e["default"]=m.exports}});